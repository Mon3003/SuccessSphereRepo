"'One2One Schedule - Manager' As screen":
    Fill: =RGBA(0, 0, 0, 0)

    comp_LeftNavMyUploads_1 As comp_LeftNav:
        Height: =668
        LeftNavCollection: |-
            =SortByColumns(Table({
                    Title: "Home",
                    NavLink: HomeScreen,
                    NavIco: Icon.Home,
                    NavVisible: 0,
                    NavSecuirty : true
                },
                {
                    Title: "Complete My Survey",
                    NavLink: 'One2One Complete Survey',
                    NavIco: Icon.AddDocument,
                    NavVisible: 1,
                    NavSecuirty : true
                },
                {
                    Title: "View My Surveys",
                    NavLink: 'One2One View My Survey',
                    NavIco: Icon.DocumentWithContent,
                    NavVisible: 2,
                    NavSecuirty : true
                },
                {
                    Title: "Schedule One2One",
                    NavLink: 'One2One Schedule - Manager',
                    NavIco: Icon.AddToCalendar,
                    NavVisible: 3,
                    NavSecuirty : If(gblCurrentUserRole.Role = "Manager",true,false)
                },
                {
                    Title: "Complete Manager Feedback",
                    NavLink: 'One2One Complete Manager Feedback - Manager',
                    NavIco: Icon.DockCheckProperties,
                    NavVisible: 4,
                    NavSecuirty : If(gblCurrentUserRole.Role = "Manager",true,false)
                }),"NavVisible",SortOrder.Ascending)
        Width: =98
        Y: =100

    "'Schedule Functionality' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =18

        "'Employee Dropdown' As dropdown":
            ChevronBackground: =RGBA(57, 55, 104, 1)
            ChevronHoverBackground: =
            Font: =gblAppFont
            Height: =25
            HoverBorderColor: =
            HoverColor: =
            Items: |-
                =Filter(
                    Distinct(UserSecurity, If(ManagerEmail.Value = gblCurrentUserEmail,EmployeeName.DisplayName)), 
                    Value <>Blank()
                    )
            SelectionFill: =RGBA(57, 55, 104, 1)
            Size: =10
            Width: =180
            X: =348
            Y: =134
            ZIndex: =8

        "'EmployeeName Label' As label":
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =25
            Size: =10
            Text: |-
                ="Employee Name :"
            X: =178
            Y: =134
            ZIndex: =9

        "'One2One StartDate Label' As label":
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =25
            Size: =10
            Text: |-
                ="One2One Start Date :"
            X: =178
            Y: =183
            ZIndex: =11

        "'Frequency Label' As label":
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =25
            Size: =10
            Text: |-
                ="Frequency :"
            X: =178
            Y: =227
            ZIndex: =12

        StartDatePicker As datepicker:
            Font: =Font.Lato
            Height: |
                =25
            IconBackground: =RGBA(57, 55, 104, 1)
            Size: =10
            Width: =180
            X: =348
            Y: =183
            ZIndex: =13

        "'Frequency Dropdown' As dropdown":
            ChevronBackground: =RGBA(57, 55, 104, 1)
            ChevronHoverBackground: =
            Font: =gblAppFont
            Height: =25
            HoverBorderColor: =
            HoverColor: =
            Items: =Choices('Schedule One2One'.Frequency)
            SelectionFill: =RGBA(57, 55, 104, 1)
            Size: =10
            Width: =180
            X: =348
            Y: =227
            ZIndex: =14

        "'Submit Button' As button":
            Color: =RGBA(241, 244, 249, 1)
            Fill: =RGBA(209, 27, 30, 1)
            Font: =gblAppFont
            Height: =26
            HoverFill: =RGBA(99, 139, 44, 1)
            OnSelect: |-
                =UpdateContext({currRecord : LookUp('Schedule One2One',EmployeeName.DisplayName = 'Employee Dropdown'.Selected.Value)});
                
                Patch(
                    'Schedule One2One', 
                     If(IsBlank(currRecord),Defaults('Schedule One2One'),currRecord),
                    {
                        EmployeeName: LookUp(UserSecurity,Title = 'Employee Dropdown'.Selected.Value).EmployeeName,
                        StartDate: StartDatePicker.SelectedDate,
                        Frequency: 'Frequency Dropdown'.Selected
                       /* 'NextOne2One Date': 
                                Switch ( Dropdown2_3.Selected.Value,
                                "Weekly",  
                                If(
                                     DatePicker1.SelectedDate >= Tempdate,
                                     DatePicker1.SelectedDate, // True condition
                                     DatePicker1.SelectedDate + RoundUp((Tempdate - DatePicker1.SelectedDate) / 7, 0) * 7 // False condition
                                ),
                                "Fortnightly",
                                If(
                                    DatePicker1.SelectedDate >= Tempdate,
                                    DatePicker1.SelectedDate, // True condition
                                    DatePicker1.SelectedDate + RoundUp((Tempdate - DatePicker1.SelectedDate) / 14, 0) * 14 // False condition
                                  )
                                )*/
                    }
                )
            Size: =11
            Text: ="SUBMIT"
            Width: =81
            X: =348
            Y: =279
            ZIndex: =17

    "'Screen Header' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =18

        "'Main Header Label' As label":
            Align: =Align.Center
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =50
            Size: =18
            Text: ="One 2 One"
            Width: =1366
            ZIndex: =2

        "'Sub-Header Label' As label":
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(57, 55, 104, 1)
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =50
            Text: ="Schedule One2One"
            Width: =1366
            Y: =50
            ZIndex: =3

        "'User Image_3' As image":
            Height: =50
            Image: =User().Image
            RadiusBottomLeft: =50
            RadiusBottomRight: =50
            RadiusTopLeft: =50
            RadiusTopRight: =50
            Width: =50
            X: =1301
            ZIndex: =5

        "'UserName Label' As label":
            Align: =Align.Right
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =11
            Text: |
                =User().FullName
            Width: =126
            X: =1175
            Y: =10
            ZIndex: =6

        "'Stretch Logo' As image":
            Height: =50
            Image: ='Stretch-365-IA-Logo-Light-Transparent (1)'
            Width: =146
            ZIndex: =7

    "'Display Table' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =18

        "Gallery3_3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            Height: =587
            Items: |-
                =Filter(
                    Distinct('Schedule One2One', If(Lower('Created By'.Email) = gblCurrentUserEmail,EmployeeName.DisplayName)), 
                    Value <>Blank()
                    )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =44
            Width: =560
            X: =791
            Y: =161
            ZIndex: =15

            Separator6_3 As rectangle:
                Fill: =RGBA(204, 231, 246, 0.28)
                Height: =8
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =1

            Subtitle2_52 As label:
                Font: =gblAppFont
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =25
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: |+
                    =
                    //LookUp('Schedule One2One',EmployeeName.DisplayName = ThisItem.Value).'NextOne2One Date'
                    With(
                         { EmpSched: LookUp('Schedule One2One', EmployeeName.DisplayName = ThisItem.Value) , Tempdate : Today()},
                    
                    Switch ( EmpSched.Frequency.Value,
                            "Weekly",  
                                If(
                                    EmpSched.StartDate >= Tempdate,
                                    EmpSched.StartDate, // True condition
                                    EmpSched.StartDate + RoundUp((Tempdate - EmpSched.StartDate) / 7, 0) * 7 // False condition
                                    ),
                            "Fortnightly",
                            If(
                                EmpSched.StartDate >= Tempdate,
                                EmpSched.StartDate, // True condition
                                EmpSched.StartDate + RoundUp((Tempdate - EmpSched.StartDate) / 14, 0) * 14 // False condition
                                ),
                            
                            "Monthly",
                            If(
                                EmpSched.StartDate >= Tempdate,
                                EmpSched.StartDate, // True condition
                                EmpSched.StartDate + RoundUp((Tempdate - EmpSched.StartDate) / 28, 0) * 28 // False condition
                                )
                            )
                    )
                    
                VerticalAlign: =VerticalAlign.Top
                Width: =284
                X: =322
                Y: =10
                ZIndex: =2

            Subtitle2_51 As label:
                Font: =gblAppFont
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =25
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: =LookUp('Schedule One2One',EmployeeName.DisplayName = ThisItem.Value).Frequency.Value
                VerticalAlign: =VerticalAlign.Top
                Width: ='Frq Label'.Width
                X: =172
                Y: =10
                ZIndex: =3

            Subtitle2_50 As label:
                Font: =gblAppFont
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =25
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: =ThisItem.Value
                VerticalAlign: =VerticalAlign.Top
                Width: ='Emp Label'.Width
                X: |
                    ='Emp Label'.X+2
                Y: =10
                ZIndex: =4

        "'Gallery Headers' As groupContainer.manualLayoutContainer":
            Height: =50
            Width: =561
            X: =789
            Y: =113
            ZIndex: =16

            "'Emp Label' As label":
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(204, 231, 246, 0.28)
                FocusedBorderThickness: =4
                Font: =gblAppFont
                FontWeight: =FontWeight.Semibold
                Height: =29
                HoverBorderColor: ='Emp Label'.BorderColor
                HoverColor: ='Emp Label'.Color
                HoverFill: ='Emp Label'.Fill
                PressedBorderColor: ='Emp Label'.BorderColor
                PressedColor: ='Emp Label'.Color
                PressedFill: ='Emp Label'.Fill
                Size: =gblAppFontSize
                Text: ="Employee Name"
                Width: =170
                ZIndex: =1

            "'Frq Label' As label":
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(204, 231, 246, 0.28)
                FocusedBorderThickness: =4
                Font: =gblAppFont
                FontWeight: =FontWeight.Semibold
                Height: =29
                HoverBorderColor: ='Frq Label'.BorderColor
                HoverColor: ='Frq Label'.Color
                HoverFill: ='Frq Label'.Fill
                PressedBorderColor: ='Frq Label'.BorderColor
                PressedColor: ='Frq Label'.Color
                PressedFill: ='Frq Label'.Fill
                Size: =gblAppFontSize
                Text: ="Frequency"
                X: ='Emp Label'.X+'Emp Label'.Width + 2
                ZIndex: =2

            "'Next 121 Label' As label":
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(204, 231, 246, 0.28)
                FocusedBorderThickness: =4
                Font: =gblAppFont
                FontWeight: =FontWeight.Semibold
                Height: =29
                HoverBorderColor: ='Next 121 Label'.BorderColor
                HoverColor: ='Next 121 Label'.Color
                HoverFill: ='Next 121 Label'.Fill
                PressedBorderColor: ='Next 121 Label'.BorderColor
                PressedColor: ='Next 121 Label'.Color
                PressedFill: ='Next 121 Label'.Fill
                Size: =gblAppFontSize
                Text: ="Next One2One Date"
                Width: =281
                X: =326
                ZIndex: =3

