"'One2One Schedule - Manager' As screen":
    Fill: =RGBA(0, 0, 0, 0)

    comp_LeftNavMyUploads_1 As comp_LeftNav:
        Height: =668
        LeftNavCollection: |-
            =SortByColumns(Table({
                    Title: "Home",
                    NavLink: HomeScreen,
                    NavIco: Icon.Home,
                    NavVisible: 0,
                    NavSecuirty : true
                },
                {
                    Title: "Complete My Survey",
                    NavLink: 'One2One Complete Survey',
                    NavIco: Icon.AddDocument,
                    NavVisible: 1,
                    NavSecuirty : true
                },
                {
                    Title: "View My Surveys",
                    NavLink: 'One2One View My Survey',
                    NavIco: Icon.DocumentWithContent,
                    NavVisible: 2,
                    NavSecuirty : true
                },
                {
                    Title: "Schedule One2One",
                    NavLink: 'One2One Schedule - Manager',
                    NavIco: Icon.AddToCalendar,
                    NavVisible: 3,
                    NavSecuirty : If(gblCurrentUserRole.Role = "Manager",true,false)
                },
                {
                    Title: "Complete Manager Feedback",
                    NavLink: 'One2One Complete Manager Feedback - Manager',
                    NavIco: Icon.DockCheckProperties,
                    NavVisible: 4,
                    NavSecuirty : If(gblCurrentUserRole.Role = "Manager",true,false)
                }),"NavVisible",SortOrder.Ascending)
        Width: =98
        Y: =100
        ZIndex: =2

    "'Display Table Container' As groupContainer":
        Fill: =RGBA(255, 255, 255, 1)
        Height: =615
        Width: =757
        X: =282
        Y: =115
        ZIndex: =18

        "Gallery3_3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            Height: =375
            Items: |-
                =Filter(
                    Distinct(
                        'Schedule One2One',
                        If(
                           Lower('Created By'.Email) = gblCurrentUserEmail,
                            EmployeeName.DisplayName
                        )
                    ),
                    Value in Distinct(
                        UserSecurity,
                        If(
                            ManagerEmail.Value = gblCurrentUserEmail,
                            EmployeeName.DisplayName, ""
                        )
                    )
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =44
            Width: =727
            X: =4
            Y: =68
            ZIndex: =1

            Separator6_3 As rectangle:
                Fill: =RGBA(216, 235, 255, 0.25)
                Height: =8
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =1

            Subtitle2_52 As label:
                Font: =gblAppFont
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =25
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: |+
                    =
                    //LookUp('Schedule One2One',EmployeeName.DisplayName = ThisItem.Value).'NextOne2One Date'
                    With(
                         { EmpSched: LookUp('Schedule One2One', EmployeeName.DisplayName = ThisItem.Value) , Tempdate : Today()},
                    
                    Switch ( EmpSched.Frequency.Value,
                            "Weekly",  
                                If(
                                    EmpSched.StartDate >= Tempdate,
                                    EmpSched.StartDate, // True condition
                                    EmpSched.StartDate + RoundUp((Tempdate - EmpSched.StartDate) / 7, 0) * 7 // False condition
                                    ),
                            "Fortnightly",
                            If(
                                EmpSched.StartDate >= Tempdate,
                                EmpSched.StartDate, // True condition
                                EmpSched.StartDate + RoundUp((Tempdate - EmpSched.StartDate) / 14, 0) * 14 // False condition
                                ),
                            
                            "Monthly",
                            If(
                                EmpSched.StartDate >= Tempdate,
                                EmpSched.StartDate, // True condition
                                EmpSched.StartDate + RoundUp((Tempdate - EmpSched.StartDate) / 28, 0) * 28 // False condition
                                )
                            )
                    )
                    
                VerticalAlign: =VerticalAlign.Top
                Width: =220
                X: =468
                Y: =10
                ZIndex: =2

            Subtitle2_51 As label:
                Font: =gblAppFont
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =25
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: =LookUp('Schedule One2One',EmployeeName.DisplayName = ThisItem.Value).Frequency.Value
                VerticalAlign: =VerticalAlign.Top
                Width: =180
                X: =268
                Y: =10
                ZIndex: =3

            Subtitle2_50 As label:
                Font: =gblAppFont
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =25
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =10
                Text: =ThisItem.Value
                VerticalAlign: =VerticalAlign.Top
                Width: =266
                X: |
                    ='Emp Label'.X+2
                Y: =10
                ZIndex: =4

        "'Gallery Headers' As groupContainer.manualLayoutContainer":
            Fill: =RGBA(255, 255, 255, 1)
            Height: =33
            Width: =726
            X: =4
            Y: =40
            ZIndex: =2

            "'Emp Label' As label":
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(216, 235, 255, 0.25)
                FocusedBorderThickness: =4
                Font: =gblAppFont
                FontWeight: =FontWeight.Semibold
                Height: =29
                HoverBorderColor: ='Emp Label'.BorderColor
                HoverColor: ='Emp Label'.Color
                HoverFill: ='Emp Label'.Fill
                PressedBorderColor: ='Emp Label'.BorderColor
                PressedColor: ='Emp Label'.Color
                PressedFill: ='Emp Label'.Fill
                Size: =gblAppFontSize
                Text: ="Employee Name"
                Underline: =true
                Width: =268
                ZIndex: =1

            "'Frq Label' As label":
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(216, 235, 255, 0.25)
                FocusedBorderThickness: =4
                Font: =gblAppFont
                FontWeight: =FontWeight.Semibold
                Height: =29
                HoverBorderColor: ='Frq Label'.BorderColor
                HoverColor: ='Frq Label'.Color
                HoverFill: ='Frq Label'.Fill
                PressedBorderColor: ='Frq Label'.BorderColor
                PressedColor: ='Frq Label'.Color
                PressedFill: ='Frq Label'.Fill
                Size: =gblAppFontSize
                Text: ="Frequency"
                Underline: =true
                Width: |+
                    =193
                    
                    
                X: ='Emp Label'.X+'Emp Label'.Width + 2
                ZIndex: =2

            "'Next 121 Label' As label":
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(216, 235, 255, 0.25)
                FocusedBorderThickness: =4
                Font: =gblAppFont
                FontWeight: =FontWeight.Semibold
                Height: =29
                HoverBorderColor: ='Next 121 Label'.BorderColor
                HoverColor: ='Next 121 Label'.Color
                HoverFill: ='Next 121 Label'.Fill
                PressedBorderColor: ='Next 121 Label'.BorderColor
                PressedColor: ='Next 121 Label'.Color
                PressedFill: ='Next 121 Label'.Fill
                Size: =gblAppFontSize
                Text: ="Next One2One Date"
                Underline: =true
                Width: =258
                X: =466
                ZIndex: =3

        Label6 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(57, 55, 104, 1)
            Font: =Font.Lato
            Height: =33
            Size: =11
            Text: ="Current Employee Schedule"
            Width: =726
            X: =4
            Y: =7
            ZIndex: =3

        Button3_4 As button:
            Color: =RGBA(99, 139, 44, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Font: =gblAppFont
            Height: =25
            HoverFill: =RGBA(99, 139, 44, 1)
            OnSelect: =Set(popup, true)
            Size: =10
            Text: ="Add / Edit"
            Width: =70
            X: =655
            Y: =11
            ZIndex: =5

    "'Screen Header' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =18

        "'Main Header Label' As label":
            Align: =Align.Center
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =50
            Size: =18
            Text: ="One 2 One"
            Width: =1366
            ZIndex: =3

        "'Sub-Header Label' As label":
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(57, 55, 104, 1)
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =50
            Text: ="Schedule One2One"
            Width: =1366
            Y: =50
            ZIndex: =4

        "'User Image_3' As image":
            Height: =50
            Image: =User().Image
            RadiusBottomLeft: =50
            RadiusBottomRight: =50
            RadiusTopLeft: =50
            RadiusTopRight: =50
            Width: =50
            X: =1301
            ZIndex: =5

        "'UserName Label' As label":
            Align: =Align.Right
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =11
            Text: |
                =User().FullName
            Width: =126
            X: =1175
            Y: =10
            ZIndex: =6

        "'Stretch Logo' As image":
            Height: =50
            Image: ='Stretch-365-IA-Logo-Light-Transparent (1)'
            Width: =146
            ZIndex: =7

    "'Schedule Container' As groupContainer":
        ContentLanguage: =
        DropShadow: =DropShadow.ExtraBold
        Fill: =RGBA(237, 237, 237, 1)
        Height: =265
        Visible: =popup
        Width: =499
        X: =411
        Y: =266
        ZIndex: =19

        "'Employee Dropdown' As dropdown":
            ChevronBackground: =RGBA(57, 55, 104, 1)
            ChevronHoverBackground: =
            Font: =gblAppFont
            Height: =25
            HoverBorderColor: =
            HoverColor: =
            Items: |-
                =Filter(
                    Distinct(UserSecurity, If(ManagerEmail.Value = gblCurrentUserEmail,EmployeeName.DisplayName)), 
                    Value <>Blank()
                    )
            SelectionFill: =RGBA(57, 55, 104, 1)
            Size: =10
            Width: =197
            X: =187
            Y: =40
            ZIndex: =1

        "'EmployeeName Label' As label":
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =25
            Size: =10
            Text: |-
                ="Employee Name :"
            Width: =165
            Y: =40
            ZIndex: =2

        "'One2One StartDate Label' As label":
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =25
            Size: =10
            Text: |-
                ="One2One Start Date :"
            Width: =165
            Y: =86
            ZIndex: =3

        "'Frequency Label' As label":
            Font: =gblAppFont
            FontWeight: =FontWeight.Semibold
            Height: =25
            Size: =10
            Text: |-
                ="Frequency :"
            Width: =165
            Y: =133
            ZIndex: =4

        StartDatePicker As datepicker:
            Font: =Font.Lato
            Height: =25
            IconBackground: =RGBA(57, 55, 104, 1)
            Size: =10
            Width: =197
            X: =187
            Y: =89
            ZIndex: =5

        "'Frequency Dropdown' As dropdown":
            ChevronBackground: =RGBA(57, 55, 104, 1)
            ChevronHoverBackground: =
            Font: =gblAppFont
            Height: =25
            HoverBorderColor: =
            HoverColor: =
            Items: =Choices('Schedule One2One'.Frequency)
            SelectionFill: =RGBA(57, 55, 104, 1)
            Size: =10
            Width: =197
            X: =187
            Y: =133
            ZIndex: =6

        "'Submit Button' As button":
            Color: =RGBA(241, 244, 249, 1)
            Fill: =RGBA(209, 27, 30, 1)
            Font: =gblAppFont
            Height: =26
            HoverFill: =RGBA(99, 139, 44, 1)
            OnSelect: |-
                =UpdateContext({currRecord : LookUp('Schedule One2One',EmployeeName.DisplayName = 'Employee Dropdown'.Selected.Value)});
                
                Patch(
                    'Schedule One2One', 
                     If(IsBlank(currRecord),Defaults('Schedule One2One'),currRecord),
                    {
                        EmployeeName: LookUp(UserSecurity,Title = 'Employee Dropdown'.Selected.Value).EmployeeName,
                        StartDate: StartDatePicker.SelectedDate,
                        Frequency: 'Frequency Dropdown'.Selected
                    }
                );
                Set(popup,false)
            Size: =11
            Text: ="SUBMIT"
            Width: =89
            X: =187
            Y: =185
            ZIndex: =7

        "'Cancel Icon' As icon.CancelBadge":
            Color: =RGBA(0, 0, 0, 1)
            Height: =39
            HoverColor: =RGBA(255, 0, 0, 1)
            Icon: =Icon.CancelBadge
            OnSelect: =Set(popup,false)
            Width: =29
            X: =466
            Y: =1
            ZIndex: =8

